# R-functions-BiomJ-ME-NL
Main R functions for the (submitted) paper: Ferreira Guerra _et al._ Assessing the Impact of Measurement Error on Fractional Polynomials and Spline Estimates of Non-Linear Dose-Response Functions: A Simulation Study. Re-submitted to Biometrical Journal, Jan 2026. This paper aims to investigate, by simulation the effect of measurement error on estimates of popular non-linear estimation methods when the covariate with non-linear effects is subject to measurement error.

This repository contains the main functions used in the simulation study in the above paper. The R files are organized as follows, according to the different scenarios evaluated in the simulation study: (i) three different true X distributions (Normal, SBP, Uniform) and (ii) six different true f(X) for each different distribution in (i). Within each of these R files, the main function permits adjustement of (a) the sample size, (b) the strength of measurement error, and (c) the prevalence of the outcome Y (here binary). This main function then generates the true X (according to the pre-defined distribution), the covariate X* measured with error (from a classical measurement error model according to the specified error ratio), the Y values (based on the pre-defined true f(X) and the specified prevalence). It then estimates f(X) based on both X and X* using four methods: (1) unpenalized cubic B-splines, (2) natural splines, (3) Fractional Polynomials, and (4) P-splines. Finally, for each estimation method, the function outputs estimated f(X) values for 300 values in the range [100, 200].
